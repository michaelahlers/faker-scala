version: '{build}'

#os: Windows Server 2016

image:
  - Ubuntu
  - Visual Studio 2017

platform:
  - x64

stack:
  - jdk 11

environment:
  APPVEYOR_SAVE_CACHE_ON_ERROR: true

build_script:
  - sbt -version
#  - sbt +test:compile

#test_script:
#  - sbt +test

for:

-
  matrix:
    only:
      - image: Visual Studio 2017

  environment:
    matrix:
      - JAVA_HOME: C:\Program Files\Java\jdk1.8.0
      - JAVA_HOME: C:\Program Files\Java\jdk11
      - JAVA_HOME: C:\Program Files\Java\jdk14

  install:
    - cmd: SET PATH=%PATH%;%JAVA_HOME%\bin
    - cmd: SET PATH=%PATH%;%PROGRAMFILES(X86)%\sbt\bin
    - cmd: choco install sbt

  cache:
    - '%LOCALAPPDATA%\Coursier\Cache -> **\dependencies.sbt, project\*'
    - '%USERPROFILE%\.ivy2 -> **\dependencies.sbt, project\*'
    - '%USERPROFILE%\.sbt -> **\dependencies.sbt, project\*'

-
  matrix:
    only:
      - image: Ubuntu

  install:
    - sh: echo "deb https://repo.scala-sbt.org/scalasbt/debian all main" | sudo tee /etc/apt/sources.list.d/sbt.list
    - sh: echo "deb https://repo.scala-sbt.org/scalasbt/debian /" | sudo tee /etc/apt/sources.list.d/sbt_old.list
    - sh: curl -sL "https://keyserver.ubuntu.com/pks/lookup?op=get&search=0x2EE0EA64E40A89B84B2DF73499E82A75642AC823" | sudo apt-key add
    - sh: sudo apt-get update
    - sh: sudo apt-get install sbt
